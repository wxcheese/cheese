<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>wxCheese - Where your smile grows and travels far</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 引入思源宋体，增强禅意美学 -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* 禅意配色方案 */
            --zen-gold: #9E7B5B; /* 柔和的砂金 */
            --zen-sand: #FBF9F6; /* 接近纯白的背景 */
            --zen-ink: #333333; /* 深墨色 */
        }
        body {
            font-family: 'Noto Serif SC', serif;
            background-color: var(--zen-sand); /* 纯白背景 */
            color: var(--zen-ink);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden; /* 确保纯净的画布效果 */
        }
        /* 核心居中容器 */
        .wisdom-container {
            max-width: 80%;
            text-align: center;
            padding: 20px;
        }
        /* 动画 */
        .fade-in {
            animation: fadeIn 1.2s ease-out forwards; /* 动画更慢、更平滑 */
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
    
    <!-- 核心 JavaScript 逻辑：格言获取 -->
    <script type="module">
        
        // --- Global Configuration ---
        const GEMINI_API_URL_TEXT = 'https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=';
        const GEMINI_API_KEY = ""; // Canvas will provide key at runtime
        
        // 移除了所有 Firebase 相关的配置和变量


        /**
         * Fetch function with exponential backoff for resilience.
         */
        async function fetchWithRetry(url, payload, maxRetries = 5) {
            for (let i = 0; i < maxRetries; i++) {
                try {
                    const response = await fetch(url + GEMINI_API_KEY, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    if (response.ok) {
                        return await response.json();
                    }
                    if (response.status === 400 || response.status === 401) {
                        throw new Error(`API Error: ${response.statusText}`);
                    }
                } catch (error) {
                    if (i === maxRetries - 1) throw error;
                    const delay = Math.pow(2, i) * 1000;
                    await new Promise(resolve => setTimeout(resolve, delay));
                }
            }
        }
        
        // 移除了 initializeFirebase 和 initializeCounter 函数
        

        /**
         * Fetches the random English Zen quote using Gemini API.
         */
        async function fetchInitialWisdom() {
            const quoteElement = document.getElementById('wisdom-quote');
            
            // 随机种子确保每次刷新获得不同的金句
            const randomSeed = Math.random().toString(36).substring(2, 7); 

            // 系统提示确保内容简洁且固定为英文
            const systemPrompt = `You are a supremely wise Zen master. Provide a single, concise, profound English phrase or sentence for guidance and introspection for the day. The quote MUST NOT be longer than 20 characters (including spaces). Do not include any punctuation, sources, or quotation marks.`;
            const userQuery = `Give me a unique maxim about the present moment, impermanence, or simplicity. Seed: ${randomSeed}`;
            
            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                systemInstruction: { parts: [{ text: systemPrompt }] },
            };
            
            try {
                const result = await fetchWithRetry(GEMINI_API_URL_TEXT, payload);
                const text = result?.candidates?.[0]?.content?.parts?.[0]?.text || 
                             "The present moment is your final master"; // Fallback
                
                // 设置内容并触发淡入动画
                quoteElement.textContent = text.trim();
                quoteElement.classList.add('fade-in');
                
            } catch (e) {
                console.error("Error fetching wisdom quote:", e);
                quoteElement.textContent = "The present moment is your final master"; // Fallback
                quoteElement.classList.add('fade-in'); 
            }
        }
        
        // Launch application upon window load
        window.onload = function() {
             // 仅调用获取格言的函数
             fetchInitialWisdom();
        };

    </script>
</head>
<body>

    <!-- 移除了 Top Bar: Serial Number -->

    <!-- Main Canvas Content: Pure Quote -->
    <div class="wisdom-container">
        <!-- Main Quote -->
        <h1 id="wisdom-quote" class="text-4xl md:text-6xl font-bold text-zen-ink opacity-0 transition-opacity">
            Contemplating...
        </h1>
    </div>
    
    <!-- Footer: Alert Message Container (Placeholder) -->
    <div id="alert-container" class="fixed bottom-4 right-4 z-50 flex flex-col items-end pointer-events-none">
    </div>

</body>
</html>
